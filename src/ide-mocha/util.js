"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.mkaddress = mkaddress;
exports.mkaddressinfo = mkaddressinfo;
exports.mkcommandinfo = mkcommandinfo;
exports.mkstats = mkstats;

var _os = _interopRequireDefault(require("os"));

var _path = _interopRequireDefault(require("path"));

var _hashToPort = _interopRequireDefault(require("hash-to-port"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function mkaddress({
  root,
  type = 'unix'
}) {
  const name = _path.default.basename(root);

  switch (type) {
    case 'unix':
      return _path.default.resolve(_os.default.tmpdir(), `ide-mocha-${name}.sock`);

    case 'IP':
      return (0, _hashToPort.default)(name);

    default:
      throw new Error(`Unknown address interface type: ${type}`);
  }
}

function mkaddressinfo({
  address
}) {
  return typeof address === 'string' ? address : `${address.address}:${address.port} (${address.family})`;
}

function mkcommandinfo({
  address
}) {
  return ['npx mocha', '--reporter mocha-reporter-remote', `--reporter-options address=${address}`].join(' ');
}

function mkstats({
  runner
}) {
  return [`Passing: ${runner.stats.passes}`, `Failing: ${runner.stats.failures}`, `Pending: ${runner.stats.pending}`, `Duration: ${runner.stats.duration} ms`].join('\n');
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWwubWpzIl0sIm5hbWVzIjpbIm1rYWRkcmVzcyIsInJvb3QiLCJ0eXBlIiwibmFtZSIsInBhdGgiLCJiYXNlbmFtZSIsInJlc29sdmUiLCJvcyIsInRtcGRpciIsIkVycm9yIiwibWthZGRyZXNzaW5mbyIsImFkZHJlc3MiLCJwb3J0IiwiZmFtaWx5IiwibWtjb21tYW5kaW5mbyIsImpvaW4iLCJta3N0YXRzIiwicnVubmVyIiwic3RhdHMiLCJwYXNzZXMiLCJmYWlsdXJlcyIsInBlbmRpbmciLCJkdXJhdGlvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBRUEsU0FBU0EsU0FBVCxDQUFtQjtBQUFFQyxFQUFBQSxJQUFGO0FBQVFDLEVBQUFBLElBQUksR0FBRztBQUFmLENBQW5CLEVBQTRDO0FBQzFDLFFBQU1DLElBQUksR0FBR0MsY0FBS0MsUUFBTCxDQUFjSixJQUFkLENBQWI7O0FBRUEsVUFBUUMsSUFBUjtBQUNFLFNBQUssTUFBTDtBQUNFLGFBQU9FLGNBQUtFLE9BQUwsQ0FBYUMsWUFBR0MsTUFBSCxFQUFiLEVBQTJCLGFBQVlMLElBQUssT0FBNUMsQ0FBUDs7QUFDRixTQUFLLElBQUw7QUFDRSxhQUFPLHlCQUFXQSxJQUFYLENBQVA7O0FBQ0Y7QUFDRSxZQUFNLElBQUlNLEtBQUosQ0FBVyxtQ0FBa0NQLElBQUssRUFBbEQsQ0FBTjtBQU5KO0FBUUQ7O0FBRUQsU0FBU1EsYUFBVCxDQUF1QjtBQUFFQyxFQUFBQTtBQUFGLENBQXZCLEVBQW9DO0FBQ2xDLFNBQU8sT0FBT0EsT0FBUCxLQUFtQixRQUFuQixHQUNIQSxPQURHLEdBRUYsR0FBRUEsT0FBTyxDQUFDQSxPQUFRLElBQUdBLE9BQU8sQ0FBQ0MsSUFBSyxLQUFJRCxPQUFPLENBQUNFLE1BQU8sR0FGMUQ7QUFHRDs7QUFFRCxTQUFTQyxhQUFULENBQXVCO0FBQUVILEVBQUFBO0FBQUYsQ0FBdkIsRUFBb0M7QUFDbEMsU0FBTyxDQUNMLFdBREssRUFFTCxrQ0FGSyxFQUdKLDhCQUE2QkEsT0FBUSxFQUhqQyxFQUlMSSxJQUpLLENBSUEsR0FKQSxDQUFQO0FBS0Q7O0FBRUQsU0FBU0MsT0FBVCxDQUFpQjtBQUFFQyxFQUFBQTtBQUFGLENBQWpCLEVBQTZCO0FBQzNCLFNBQU8sQ0FDSixZQUFXQSxNQUFNLENBQUNDLEtBQVAsQ0FBYUMsTUFBTyxFQUQzQixFQUVKLFlBQVdGLE1BQU0sQ0FBQ0MsS0FBUCxDQUFhRSxRQUFTLEVBRjdCLEVBR0osWUFBV0gsTUFBTSxDQUFDQyxLQUFQLENBQWFHLE9BQVEsRUFINUIsRUFJSixhQUFZSixNQUFNLENBQUNDLEtBQVAsQ0FBYUksUUFBUyxLQUo5QixFQUtMUCxJQUxLLENBS0EsSUFMQSxDQUFQO0FBTUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgb3MgZnJvbSAnb3MnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGhhc2hUb1BvcnQgZnJvbSAnaGFzaC10by1wb3J0J1xuXG5mdW5jdGlvbiBta2FkZHJlc3MoeyByb290LCB0eXBlID0gJ3VuaXgnIH0pIHtcbiAgY29uc3QgbmFtZSA9IHBhdGguYmFzZW5hbWUocm9vdClcblxuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICd1bml4JzpcbiAgICAgIHJldHVybiBwYXRoLnJlc29sdmUob3MudG1wZGlyKCksIGBpZGUtbW9jaGEtJHtuYW1lfS5zb2NrYClcbiAgICBjYXNlICdJUCc6XG4gICAgICByZXR1cm4gaGFzaFRvUG9ydChuYW1lKVxuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gYWRkcmVzcyBpbnRlcmZhY2UgdHlwZTogJHt0eXBlfWApXG4gIH1cbn1cblxuZnVuY3Rpb24gbWthZGRyZXNzaW5mbyh7IGFkZHJlc3MgfSkge1xuICByZXR1cm4gdHlwZW9mIGFkZHJlc3MgPT09ICdzdHJpbmcnXG4gICAgPyBhZGRyZXNzXG4gICAgOiBgJHthZGRyZXNzLmFkZHJlc3N9OiR7YWRkcmVzcy5wb3J0fSAoJHthZGRyZXNzLmZhbWlseX0pYFxufVxuXG5mdW5jdGlvbiBta2NvbW1hbmRpbmZvKHsgYWRkcmVzcyB9KSB7XG4gIHJldHVybiBbXG4gICAgJ25weCBtb2NoYScsXG4gICAgJy0tcmVwb3J0ZXIgbW9jaGEtcmVwb3J0ZXItcmVtb3RlJyxcbiAgICBgLS1yZXBvcnRlci1vcHRpb25zIGFkZHJlc3M9JHthZGRyZXNzfWAsXG4gIF0uam9pbignICcpXG59XG5cbmZ1bmN0aW9uIG1rc3RhdHMoeyBydW5uZXIgfSkge1xuICByZXR1cm4gW1xuICAgIGBQYXNzaW5nOiAke3J1bm5lci5zdGF0cy5wYXNzZXN9YCxcbiAgICBgRmFpbGluZzogJHtydW5uZXIuc3RhdHMuZmFpbHVyZXN9YCxcbiAgICBgUGVuZGluZzogJHtydW5uZXIuc3RhdHMucGVuZGluZ31gLFxuICAgIGBEdXJhdGlvbjogJHtydW5uZXIuc3RhdHMuZHVyYXRpb259IG1zYCxcbiAgXS5qb2luKCdcXG4nKVxufVxuXG5leHBvcnQge1xuICBta2FkZHJlc3MsXG4gIG1rYWRkcmVzc2luZm8sXG4gIG1rY29tbWFuZGluZm8sXG4gIG1rc3RhdHMsXG59XG4iXX0=